classdef ComparisonFNC_WU < Comparison
    % ComparisonFNC_WU A comparison of functional data with weighted undirected graphs
    % ComparisonFNC_WU is a subclass of Comparison, it implements the
    % initialization of data methods.
    %
    % ComparisonFNC_WU implements the initialization of the data which the
    % class will save. It checks if the data being saved has correct
    % dimensions. Functional data can be for example fMRI data.
    %
    % ComparisonFNC_WU constructor methods:
    %  ComparisonFNC_WU             - Constructor
    %
    % ComparisonFNC_WU basic methods:
    %  disp                         - displays the comparison
    %
    % ComparisonFNC_WU get methods:
    %  getGroupValues               - returns the groups measurement value
    %  getGroupValue                - returns the group measurement value
    %  getDifference                - returns the difference between values
    %  getAllDifferences            - returns all the differecens between values
    %  getP1                        - returns the p-values single tail
    %  getP2                        - returns the p-values double tail
    %  getConfidenceIntervalMin     - returns the min value of the confidence interval
    %  getConfidenceIntervalMax     - returns the max value of the confidence interval
    %
    % ComparisonFNC_WU initialze data (Access=protected):
    %  initialize_data              - initializes and checks the data
    %
    % ComparisonFNC_WU descriptive methods (Static):
    %  getClass                     - returns the class of the comparison
    %  getName                      - returns the name of the comparison
    %  getDescription               - returns the description of the comparison
    %  getBrainAtlasNumber          - returns the number of brain atlases
    %  getAnalysisClass             - returns the class of the analysis
    %  getSubjectClass              - returns the class of the subject
    %  getAvailbleSettings          - returns the available settings
    %  getComparison                - returns a new comparison
    %
    % ComparisonFNC_WU plot methods (Static):
    %  getComparisonSettingsPanel   - returns a UIPanel
    %
    % See also Comparison, AnalysisFNC_WU, MeasurementFNC_WU, RandomComparisonFNC_WU.
    
    properties
        values_1  % array with the values_1 of the measure for each subject of group 1
        values_2  % array with the values_1 of the measure for each subject of group 1
        average_value_1  % average value of group 1
        average_value_2  % average value of group 1
        difference  % difference
        all_differences  % all differences obtained through the permutation test
        p1  % p value single tailed
        p2  % p value double tailed
        confidence_interval_min  % min value of the 95% confidence interval
        confidence_interval_max  % max value of the 95% confidence interval
    end
    methods  % Constructor
        function c =  ComparisonFNC_WU(id, label, notes, atlas, measure_code, group_1, group_2, varargin)
            % COMPARISONFNC_WU(ID, LABEL, NOTES, ATLAS, MEASURE_CODE, GROUP_1, GROUP_2)
            % creates a comparison with ID, LABEL, ATLAS, MEASURE_CODE,
            % with the data from GROUP_1 and GROUP_2. It initializes the
            % COMPARISONFNC_WU with default settings.
            %
            % COMPARISONFNC_WU(ID, LABEL, NOTES, ATLAS, MEASURE_CODE, GROUP_1, GROUP_2, PROPERTY, VALUE, ...)
            % creates a comparison with ID, LABEL, ATLAS, MEASURE_CODE,
            % with the data from GROUP_1 and GROUP_2. It initializes the
            % COMPARISONFNC_WU with VALUE settings.
            %
            % See also MeasurementFNC_WU, RandomComparisonFNC_WU, AnalysisFNC_WU.
            
            graph_type = AnalysisFNC_WU.getGraphType();
            measure_list = Graph.getCompatibleMeasureList(graph_type);
            assert(ismember(measure_code, measure_list), ...
                [BRAPH2.STR ':ComparisonFNC:' BRAPH2.BUG_FUNC], ...
                'ComparisonFNC measure_code is not compatible with the permited Measures.');
            
            c = c@Comparison(id, label, notes, atlas, measure_code, group_1, group_2, varargin{:});
        end
    end
    methods  % Get functions
        function [values_1, values_2] = getGroupValues(c)
            % GETGROUPVALUES returns the measure values of both groups
            %
            % [VALUE_1, VALUE_2] = GETGROUPVALUES(C) returns the measure
            % values of both groups.
            %
            % See also getGroupValue, getDifference, getAllDifferences.
            
            values_1 = c.values_1;
            values_2 = c.values_2;
        end
        function values = getGroupValue(c, group_index)
            % GETGROUPVALUE returns the measure value of specified group
            %
            % VALUE = GETGROUPVALUE(C, GROUP_INDEX) returns the measure value of
            % specified group.
            %
            % See also getGroupValues, getDifference, getAllDifferences.
            
            if group_index == 1
                values = c.values_1;
            else
                values = c.values_2;
            end
        end
        function [average_value_1, average_value_2] = getGroupAverageValues(c)
            % GETGROUPAVERAGEVALUES returns the measure average value of the groups
            %
            % [AVERAGEVALUE1, AVERAGEVALUE2] = GETGROUPAVERAGEVALUES(C)
            % returns the measures average values.
            %
            % See also getGroupValues, getDifference, getGroupAverageValue.
            
            average_value_1 = c.average_value_1;
            average_value_2 = c.average_value_2;
        end
        function average_value = getGroupAverageValue(c, group_index)
            % GETGROUPAVERAGEVALUE returns the measure average value of specified group
            %
            % AVERAGE_VALUE = GETGROUPAVERAGEVALUE(C, GROUP_INDEX) returns
            % the measure value of specified group.
            %
            % See also getGroupValues, getDifference, getGroupAverageValues.
            
            if group_index == 1
                average_value = c.average_value_1;
            else
                average_value = c.average_value_2;
            end
        end
        function difference = getDifference(c)
            % GETDIFFERENCE returns the difference between measure values
            %
            % DIFFERENCE = GETDIFFERENCE(C) returns the difference between
            % measure values of both groups. This difference is the mean of
            % all differences.
            %
            % See also getGroupValue, getGroupValues, getAllDifferences.
            
            difference = c.difference;
        end
        function all_differences = getAllDifferences(c)
            % GETALLDIFFERENCES returns the all differences between measure values
            %
            % ALL_DIFFERENCES = GETALLDIFFERENCE(C) returns all differences between
            % measure values of both groups.
            %
            % See also getGroupValue, getGroupValues, getDifference.
            
            all_differences = c.all_differences;
        end
        function p1 = getP1(c)
            % GETP1 returns the single tail p-value of the comparison
            %
            % P1 = GETP1(C) returns the single tail p-value of the comparison
            %
            % See also getP2, getConfidenceIntervalMin, getConfidenceIntervalMax.
            
            p1 = c.p1;
        end
        function p2 = getP2(c)
            % GETP2 returns the double tail p-value of the comparison
            %
            % P2 = GETP2(C) returns the double tail p-value of the comparison
            %
            % See also getP1, getConfidenceIntervalMin, getConfidenceIntervalMax.
            
            p2 = c.p2;
        end
        function confidence_interval_min = getConfidenceIntervalMin(c)
            % GETFNCFIDENCEINTERVALMIN returns minimum value of the confidence interval
            %
            % FNCFIDENCE_INTERVAL_MIN = GETFNCFIDENCEINTERVALMIN(C)
            % returns minimum value of the confidence interval
            %
            % See also getP1, getP2, getConfidenceIntervalMax.
            
            confidence_interval_min = c.confidence_interval_min;
        end
        function confidence_interval_max = getConfidenceIntervalMax(c)
            % GETFNCFIDENCEINTERVALMAX returns maximum value of the confidence interval
            %
            % FNCFIDENCE_INTERVAL_MAX = GETFNCFIDENCEINTERVALMAX(C)
            % returns maximum value of the confidence interval
            %
            % See also getP1, getP2, getConfidenceIntervalMin.
            
            confidence_interval_max = c.confidence_interval_max;
        end
    end
    methods (Access=protected)  % Initialize data
        function initialize_data(c, varargin)
            % INITIALIZE_DATA initialize and check the data for the comparison
            %
            % INITIALIZE_DATA(C) initialize and check the data for the
            % comparison. It initializes with default settings.
            %
            % INITIALIZE_DATA(C, PROPERTY, VALUE, ...) initialize and
            % check the data for the comparison. It initializes with VALUE settings.
            % Admissible rules are:
            %  'ComparisonFNC.PermutationNumber'  - number of permutations
            %  'ComparisonFNC.value_1'            - value of group 1
            %  'ComparisonFNC.value_2'            - value of group 2
            %  'ComparisonFNC.average_value_1'    - average value of group 1
            %  'ComparisonFNC.average_value_2'    - average value of group 2
            %  'ComparisonFNC.difference'         - value of difference
            %  'ComparisonFNC.all_differences'    - value of all differences
            %  'ComparisonFNC.p1'                 - single tail p-value
            %  'ComparisonFNC.p2'                 - double tail p-value
            %  'ComparisonFNC.confidence_min'     - min value in confidence interval
            %  'ComparisonFNC.confidence_max'     - max value in confidence interval
            %
            % See also AnalysisFNC_WU.
            
            atlases = c.getBrainAtlases();
            atlas = atlases{1};
            [group_1, group_2]  = c.getGroups();
            
            measure_code = c.getMeasureCode();
            
            number_of_permutations = c.getSettings('ComparisonFNC.PermutationNumber');
            
            if Measure.is_global(measure_code)  % global measure
                % values
                c.values_1 = get_from_varargin( ...
                    repmat({0}, 1, group_1.subjectnumber()), ...
                    'ComparisonFNC.values_1', ...
                    varargin{:});
                assert(iscell(c.getGroupValue(1)) & ...
                    isequal(size(c.getGroupValue(1)), [1, group_1.subjectnumber]) & ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getGroupValue(1))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    ['Data not compatible with ComparisonFNC_WU.'])  %#ok<*NBRAK>
                
                c.values_2 = get_from_varargin( ...
                    repmat({0}, 1, group_2.subjectnumber()), ...
                    'ComparisonFNC.values_2', ...
                    varargin{:});
                assert(iscell(c.getGroupValue(2)) & ...
                    isequal(size(c.getGroupValue(2)), [1, group_2.subjectnumber]) & ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getGroupValue(2))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    ['Data not compatible with ComparisonFNC_WU.'])
                
                % average values
                c.average_value_1 = get_from_varargin( ...
                    {0}, ...
                    'ComparisonFNC.average_values_1', ...
                    varargin{:});
                assert(iscell(c.getGroupAverageValue(1)) && ...
                    isequal(size(c.getGroupAverageValue(1)), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getGroupAverageValue(1))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.average_value_2 = get_from_varargin( ...
                    {0}, ...
                    'ComparisonFNC.average_values_2', ...
                    varargin{:});
                assert(iscell(c.getGroupAverageValue(2)) && ...
                    isequal(size(c.getGroupAverageValue(2)), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getGroupAverageValue(2))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                % statistic measures
                c.difference = get_from_varargin( ...
                    {0}, ...
                    'ComparisonFNC.difference', ...
                    varargin{:});
                assert(iscell(c.getDifference()) && ...
                    isequal(size(c.getDifference()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getDifference())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.all_differences = get_from_varargin( ...
                    repmat({0}, 1, number_of_permutations), ...
                    'ComparisonFNC.all_differences', ...
                    varargin{:});
                assert(iscell(c.getAllDifferences()) && ...
                    isequal(size(c.getAllDifferences()), [1, number_of_permutations]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getAllDifferences())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.p1 = get_from_varargin( ...
                    {0}, ...
                    'ComparisonFNC.p1', ...
                    varargin{:});
                assert(iscell(c.getP1()) && ...
                    isequal(size(c.getP1()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getP1())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.p2 = get_from_varargin( ...
                    {0}, ...
                    'ComparisonFNC.p2', ...
                    varargin{:});
                assert(iscell(c.getP2()) && ...
                    isequal(size(c.getP2()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getP2())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.confidence_interval_min = get_from_varargin( ...
                    {0}, ...
                    'ComparisonFNC.confidence_min', ...
                    varargin{:});
                assert(iscell(c.getConfidenceIntervalMin()) && ...
                    isequal(size(c.getConfidenceIntervalMin()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getConfidenceIntervalMin())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.confidence_interval_max = get_from_varargin( ...
                    {0}, ...
                    'ComparisonFNC.confidence_max', ...
                    varargin{:});
                assert(iscell(c.getConfidenceIntervalMax()) && ...
                    isequal(size(c.getConfidenceIntervalMax()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [1, 1]), c.getConfidenceIntervalMax())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
            elseif Measure.is_nodal(measure_code)  % nodal measure
                c.values_1 = get_from_varargin( ...
                    repmat({zeros(atlas.getBrainRegions().length(), 1)}, 1, group_1.subjectnumber()), ...
                    'ComparisonFNC.values_1', ...
                    varargin{:});
                assert(iscell(c.getGroupValue(1)) & ...
                    isequal(size(c.getGroupValue(1)), [1, group_1.subjectnumber]) & ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getGroupValue(1))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    ['Data not compatible with ComparisonFNC_WU.'])
                
                c.values_2 = get_from_varargin( ...
                    repmat({zeros(atlas.getBrainRegions().length(), 1)}, 1, group_2.subjectnumber()), ...
                    'ComparisonFNC.values_2', ...
                    varargin{:});
                assert(iscell(c.getGroupValue(2)) & ...
                    isequal(size(c.getGroupValue(2)), [1, group_2.subjectnumber]) & ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getGroupValue(2))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    ['Data not compatible with ComparisonFNC_WU.'])
                
                c.average_value_1 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length(), 1)}, ...
                    'ComparisonFNC.average_values_1', ...
                    varargin{:});
                assert(iscell(c.getGroupAverageValue(1)) && ...
                    isequal(size(c.getGroupAverageValue(1)), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getGroupAverageValue(1))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.average_value_2 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length(), 1)}, ...
                    'ComparisonFNC.average_values_2', ...
                    varargin{:});
                assert(iscell(c.getGroupAverageValue(2)) && ...
                    isequal(size(c.getGroupAverageValue(2)), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getGroupAverageValue(2))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                % statistic values
                c.difference = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length(), 1)}, ...
                    'ComparisonFNC.difference', ...
                    varargin{:});
                assert(iscell(c.getDifference()) && ...
                    isequal(size(c.getDifference()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getDifference())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.all_differences = get_from_varargin( ...
                    repmat({zeros(atlas.getBrainRegions().length(), 1)}, 1, number_of_permutations), ...
                    'ComparisonFNC.all_differences', ...
                    varargin{:});
                assert(iscell(c.getAllDifferences()) && ...
                    isequal(size(c.getAllDifferences()), [1, number_of_permutations]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getAllDifferences())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.p1 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length(), 1)}, ...
                    'ComparisonFNC.p1', ...
                    varargin{:});
                assert(iscell(c.getP1()) && ...
                    isequal(size(c.getP1()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getP1())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.p2 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length(), 1)}, ...
                    'ComparisonFNC.p2', ...
                    varargin{:});
                assert(iscell(c.getP2()) && ...
                    isequal(size(c.getP2()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getP2())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.confidence_interval_min = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length(), 1)}, ...
                    'ComparisonFNC.confidence_min', ...
                    varargin{:});
                assert(iscell(c.getConfidenceIntervalMin()) && ...
                    isequal(size(c.getConfidenceIntervalMin()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getConfidenceIntervalMin())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.confidence_interval_max = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length(), 1)}, ...
                    'ComparisonFNC.confidence_max', ...
                    varargin{:});
                assert(iscell(c.getConfidenceIntervalMax()) && ...
                    isequal(size(c.getConfidenceIntervalMax()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), 1]), c.getConfidenceIntervalMax())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
            elseif Measure.is_binodal(measure_code)  % binodal measure
                c.values_1 = get_from_varargin( ...
                    repmat({zeros(atlas.getBrainRegions().length())}, 1, group_1.subjectnumber()), ...
                    'ComparisonFNC.values_1', ...
                    varargin{:});
                assert(iscell(c.getGroupValue(1)) & ...
                    isequal(size(c.getGroupValue(1)), [1, group_1.subjectnumber]) & ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getGroupValue(1))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    ['Data not compatible with ComparisonFNC_WU.'])
                
                c.values_2 = get_from_varargin( ...
                    repmat({zeros(atlas.getBrainRegions().length())}, 1, group_2.subjectnumber()), ...
                    'ComparisonFNC.values_2', ...
                    varargin{:});
                assert(iscell(c.getGroupValue(2)) & ...
                    isequal(size(c.getGroupValue(2)), [1, group_2.subjectnumber]) & ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getGroupValue(2))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2.WRONG_INPUT], ...
                    ['Data not compatible with ComparisonFNC_WU.'])
                
                c.average_value_1 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length())}, ...
                    'ComparisonFNC.average_values_1', ...
                    varargin{:});
                assert(iscell(c.getGroupAverageValue(1)) && ...
                    isequal(size(c.getGroupAverageValue(1)), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getGroupAverageValue(1))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.average_value_2 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length())}, ...
                    'ComparisonFNC.average_values_2', ...
                    varargin{:});
                assert(iscell(c.getGroupAverageValue(2)) && ...
                    isequal(size(c.getGroupAverageValue(2)), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getGroupAverageValue(2))), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                % statistic values
                c.difference = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length())}, ...
                    'ComparisonFNC.difference', ...
                    varargin{:});
                assert(iscell(c.getDifference()) && ...
                    isequal(size(c.getDifference()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getDifference())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.all_differences = get_from_varargin( ...
                    repmat({zeros(atlas.getBrainRegions().length())}, 1, number_of_permutations), ...
                    'ComparisonFNC.all_differences', ...
                    varargin{:});
                assert(iscell(c.getAllDifferences()) && ...
                    isequal(size(c.getAllDifferences()), [1, number_of_permutations]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getAllDifferences())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.p1 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length())}, ...
                    'ComparisonFNC.p1', ...
                    varargin{:});
                assert(iscell(c.getP1()) && ...
                    isequal(size(c.getP1()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getP1())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.p2 = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length())}, ...
                    'ComparisonFNC.p2', ...
                    varargin{:});
                assert(iscell(c.getP2()) && ...
                    isequal(size(c.getP2()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getP2())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.confidence_interval_min = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length())}, ...
                    'ComparisonFNC.confidence_min', ...
                    varargin{:});
                assert(iscell(c.getConfidenceIntervalMin()) && ...
                    isequal(size(c.getConfidenceIntervalMin()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getConfidenceIntervalMin())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
                
                c.confidence_interval_max = get_from_varargin( ...
                    {zeros(atlas.getBrainRegions().length())}, ...
                    'ComparisonFNC.confidence_max', ...
                    varargin{:});
                assert(iscell(c.getConfidenceIntervalMax()) && ...
                    isequal(size(c.getConfidenceIntervalMax()), [1, 1]) && ...
                    all(cellfun(@(x) isequal(size(x), [atlas.getBrainRegions().length(), atlas.getBrainRegions().length()]), c.getConfidenceIntervalMax())), ...
                    [BRAPH2.STR ':ComparisonFNC_WU:' BRAPH2. WRONG_INPUT], ...
                    'Data not compatible with ComparisonFNC_WU')
            end
        end
    end
    methods (Static)  % Descriptive functions
        function class = getClass()
            % GETCLASS returns the class of functional comparison
            %
            % ANALYSIS_CLASS = GETCLASS(ANALYSIS) returns the class of
            % comparison. In this case 'ComparisonFNC_WU'.
            %
            % See also getList, getName, getDescription.
            
            class = 'ComparisonFNC_WU';
        end
        function name = getName()
            % GETNAME returns the name of functional comparison
            %
            % NAME = GETNAME() returns the name of the ComparisonFNC_WU.
            %
            % See also getList, getClass, getDescription.
            
            name = 'Comparison FNC WU';
        end
        function description = getDescription()
            % GETDESCRIPTION returns the description of functional comparison
            %
            % DESCRIPTION = GETDESCRIPTION() returns the description
            % of ComparisonFNC_WU.
            %
            % See also getList, getClass, getName.
            
            description = 'Functional comparison';
        end
        function atlas_number = getBrainAtlasNumber()
            % GETBRAINATLASNUMBER returns the number of brain atlases
            %
            % ATLAS_NUMBER = GETBRAINATLASNUMBER() returns the number of
            % brain atlases.
            %
            % See also getList, getClass, getName.
            
            atlas_number =  1;
        end
        function analysis_class = getAnalysisClass()
            % GETANALYSISCLASS returns the class of the analsysis
            %
            % ANALYSIS_CLASS = GETANALYSISCLASS() returns the class of the
            % analysis the comparison is part of, 'AnalysisFNC_WU'.
            %
            % See also getList, getClass, getName.
            
            analysis_class = 'AnalysisFNC_WU';
        end
        function subject_class = getSubjectClass()
            % GETSUBJETCLASS returns the class of functional comparison subject
            %
            % SUBJECT_CLASS = GETSUBJECT_CLASS() returns the class
            % of ComparisonFNC_WU subject, 'SubjectFNC'.
            %
            % See also getList, getClass, getName, getDescription.
            
            subject_class = 'SubjectFNC';
        end
        function available_settings = getAvailableSettings()
            % GETAVAILABLESETTINGS returns the available settings of functional comparison
            %
            % AVAILABLE_SETTINGS = GETAVAILABLESETTINGS() returns the
            % available settings of ComparisonFNC_WU.
            %
            % See also getClass, getName, getDescription
            
            available_settings = {
                'ComparisonFNC.PermutationNumber', BRAPH2.NUMERIC, 1000, {};
                };
        end
        function sub = getComparison(comparisonClass, id, label, notes, atlas, measure_code, group_1, group_2, varargin) %#ok<INUSD>
            % GETCOMPARISON returns a new comparison
            %
            % SUB = GETCOMPARISON(COMPARISON_CLASS, ID, LABEL, NOTES, ATLAS, MEASURE_CODE, GROUP_1, GROUP_2)
            % returns a new ComparisonFNC_WU object with COMPARISON_CLASS,
            % ID, LABEL, NOTES, ATLAS. The measure will be MEASURE_CODE and
            % it will initialize with default settings.
            %
            % SUB = GETCOMPARISON(COMPARISON_CLASS, ID, LABEL, NOTES, ATLAS, MEASURE_CODE, GROUP_1, GROUP_2, PROPERTY, VALUE, ...)
            % returns a new ComparisonFNC_WU object with COMPARISON_CLASS,
            % ID, LABEL, NOTES, ATLAS. The measure will be MEASURE_CODE and
            % it will initialize with VALUE settings.
            %
            % See also getClass, getName, getDescription.
            
            sub = eval([comparisonClass '(id, label, notes, atlas, measure_code, group_1, group_2, varargin{:})']);
        end
    end
    methods (Static)  % Plot ComparisonGUI Child Panel
        function handle = getComparisonSettingsPanel(analysis, uiparent) %#ok<INUSL>
            % GETCHILDPANEL returns a dynamic UIPanel
            %
            % HANDLE = GETCHILDPANEL(ANALYSIS, UIPARENT) returns a dynamic
            % UIPanel. Modificable settings are: Verbose, Interruptible and
            % Permutation.
            %
            % See also ComparisonST_WU.
            
            set(uiparent, 'Visible', 'on')
            
            ui_permutation_text = uicontrol('Parent', uiparent, 'Units', 'normalized', 'Style', 'text');
            ui_permutation_edit = uicontrol('Parent', uiparent, 'Units', 'normalized', 'Style', 'edit');
            init_child_panel()
            function init_child_panel()
                
                set(ui_permutation_text, 'String', 'Permutation Number')
                set(ui_permutation_text, 'Position', [.01 .8 .47 .14])
                set(ui_permutation_text, 'Fontweight', 'bold')
                
                set(ui_permutation_edit, 'String', 1000)
                set(ui_permutation_edit, 'Position', [.5 .87 .45 .08])
                set(ui_permutation_edit, 'Callback', {@cb_comparison_permutation})
            end
            
            function cb_comparison_permutation(~, ~)
                setappdata(uiparent, 'permutation', str2double(get(ui_permutation_edit, 'String')))
            end
            handle.variables = [];
            handle.permutation = ui_permutation_edit;
            setappdata(uiparent, 'permutation', str2double(get(ui_permutation_edit, 'String')))
        end
    end
end